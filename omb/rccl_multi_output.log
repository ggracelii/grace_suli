Running Device Collectives None...
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called

*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=1
[RCCL Check] All requirements met. Using RCCL.
>> MPIR_Allreduce_intra_ccl: Using RCCL backend


Running Composition 1 (alpha)...
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_barrier called

*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
Switch statment: MPIR_CVAR_ALLREDUCE_COMPOSITION = 1, running alpha
    comm->comm_kind == MPIR_COMM_KIND__INTRACOMM = 1
    is_commutative = 1
   After fallback check for alpha
Entered alpha algorithm
*                       MPIDI_SHM_mpi_reduce called
    [RCCL] Host buffer fallback disabled due to ENABLE_RCCL
    Node comm exists
        Not in place
            Calling SHM reduce
*                       MPIDI_SHM_mpi_reduce called
    Node roots comm exists
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=1
[RCCL Check] All requirements met. Using RCCL.
>> MPIR_Allreduce_intra_ccl: Using RCCL backend
    Node comm exists
        Calling SHM bcast
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
[0] 144 at [0xa22c520], ../src/util/ccl/rccl.c[29]
[0] 24 at [0xa718e30], ../src/util/ccl/cclcomm.c[14]
[4] 144 at [0x19051910], ../src/util/ccl/rccl.c[29]
[4] 24 at [0x19051840], ../src/util/ccl/cclcomm.c[14]


Running Composition 2 (beta)...
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_barrier called

*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
   After fallback check for beta
Entered beta algorithm
    [RCCL] Host buffer fallback disabled due to ENABLE_RCCL
    Calling NM allreduce
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=1
[RCCL Check] All requirements met. Using RCCL.
>> MPIR_Allreduce_intra_ccl: Using RCCL backend
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called


Running Composition 4 (delta)...
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_barrier called

*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
Switch statment: MPIR_CVAR_ALLREDUCE_COMPOSITION = 4, running delta
    comm->comm_kind == MPIR_COMM_KIND__INTRACOMM = 1
    count >= num_leads = 0
    is_commutative = 1
   After fallback check for delta
Entered delta algorithm
    Sub-node comm DNE, creating multi leaders
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
    Allocating shared memory buffer
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
    Intra-node leads comm exists
        Calling SHM barrier
*                       MPIDI_SHM_mpi_barrier called
        Calling SHM reduce
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_NM_mpi_bcast called (UCX)
*                           MPIR_Bcast_impl called
        Calling SHM barrier on intra_node_leads_comm
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_NM_mpi_bcast called (UCX)
*                           MPIR_Bcast_impl called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_barrier called
        Reducing data from shm buffers
            Calling local reduce
        Calling NM allreduce
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
[RCCL Check] op_supported=1, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_allreduce called (UCX)
*                           MPIR_Allreduce_impl called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
        Calling SHM barrier on node_comm
*                       MPIDI_SHM_mpi_barrier called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIDI_SHM_mpi_reduce called
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIR_Allreduce_intra_ccl called
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIR_Allreduce_intra_ccl called
[RCCL Check] op_supported=0, dtype_supported=1, buffers_on_gpu=0
>> MPIR_Allreduce_intra_ccl: RCCL requirements not met, falling back
>> MPIR_Allreduce_intra_ccl: Using fallback (recursive doubling)
*                       MPIR_Allreduce_intra_recursive_doubling called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_NM_mpi_reduce called (UCX)
*                           MPIR_Reduce_impl called
*                       MPIDI_SHM_mpi_reduce called
*                       MPIDI_SHM_mpi_bcast called
*                       MPIDI_SHM_mpi_barrier called
*                       MPIDI_NM_mpi_barrier called (UCX)
*                           MPIR_Barrier_impl called
*                       MPIDI_SHM_mpi_bcast called
